{"version":3,"file":"suku-webcomponents.umd.js.map","sources":["ng://suku-webcomponents/lib/suku-tree/suku-tree.component.ts","ng://suku-webcomponents/lib/suku-webcomponents.module.ts"],"sourcesContent":["import { Component, Input, OnChanges } from '@angular/core';\nimport * as d3 from 'd3';\n@Component({\n  selector: 'suku-tree',\n  templateUrl: './suku-tree.component.html',\n  styleUrls: ['./suku-tree.component.scss']\n})\nexport class SukuTreeComponent implements OnChanges {\n\t@Input('tree-data') treeDataFromApi;\n\t// trace tree\n\ttree;\n\troot;\n\ti;\n\tsvg;\n\tboxWidth = 180;\n\tboxHeight = 55;\n\tmargin = {\n\t\ttop: 50,\n\t\tright: 5,\n\t\tbottom: 50,\n\t\tleft: 5\n\t};\n\twidth = 1360 - this.margin.left - this.margin.right;\n\theight = 610 - this.margin.top - this.margin.bottom;\n\tdata: any;\n\tngOnChanges() {\n    console.log('called');\n\t\tif (this.treeDataFromApi) {\n      console.log('data>', this.treeDataFromApi);\n\t\t\tthis.constructTree();\n\t\t}\n\t}\n\n\tconstructTree() {\n\t const treeData = JSON.parse(this.treeDataFromApi);\n\t\tthis.i = 0;\n\t\tif (treeData) {\n\t\t\tthis.tree = d3.layout\n\t\t\t.tree()\n\t\t\t.separation((a, b) => (a.parent === b.parent ? 5 : 5.25))\n\t\t\t.children((d) => {\n\t\t\t\treturn d.childrens;\n\t\t\t})\n\t\t\t.size([ this.height, this.width ]);\n\n\t\tthis.svg = d3\n\t\t\t.select('.tree')\n\t\t\t.append('svg')\n\t\t\t.attr('width', this.width + this.margin.right + this.margin.left)\n\t\t\t.attr('height', this.height + this.margin.top + this.margin.bottom)\n\t\t\t.append('g')\n\t\t\t.attr('transform', 'translate(' + this.margin.left + ',' + this.margin.top + ')');\n\n\t\tthis.root = treeData[0];\n\t\tthis.drawTree();\n\t\t}\n\t}\n\n\tdrawTree() {\n\t\tconst nodes = this.tree.nodes(this.root).reverse();\n\t\tconst links = this.tree.links(nodes);\n\n\t\tnodes.forEach((d) => {\n\t\t\td.y = this.width - 109 - d.depth * 270; // reverse tree\n\t\t});\n\n\t\tconst node = this.svg.selectAll('g.node').data(nodes, (d) => {\n\t\t\treturn d.id || (d.id = ++this.i); // assign id to nodes\n\t\t});\n\n\t\tconst nodeEnter = node.enter().append('g').attr('class', 'node').attr('transform', (d) => {\n\t\t\treturn 'translate(' + d.y + ',' + d.x + ')'; // append g with class attr\n\t\t});\n\n\t\t// append line into svg\n\t\tnode\n\t\t\t.append('line')\n\t\t\t.style('stroke', (d) => {\n\t\t\t\tif (d.level === 1) {\n\t\t\t\t\treturn '#6f3bda';\n\t\t\t\t}\n\t\t\t\tif (d.level === 2) {\n\t\t\t\t\treturn '#3fdbef';\n\t\t\t\t}\n\t\t\t\tif (d.level === 3) {\n\t\t\t\t\treturn '#b8ce2b';\n\t\t\t\t} else {\n\t\t\t\t\treturn '#3fdbef';\n\t\t\t\t}\n\t\t\t})\n\t\t\t.attr('x1', -(this.boxWidth / 2))\n\t\t\t.attr('y1', -(this.boxHeight / 2))\n\t\t\t.attr('x2', -(this.boxWidth / 2))\n\t\t\t.attr('y2', this.boxHeight / 2)\n\t\t\t.attr('stroke-width', '10');\n\n\t\t// append rect into svg\n\t\tnode\n\t\t\t.append('rect')\n\t\t\t.attr({\n\t\t\t\tx: -(this.boxWidth / 2),\n\t\t\t\ty: -(this.boxHeight / 2),\n\t\t\t\twidth: this.boxWidth,\n\t\t\t\theight: this.boxHeight\n\t\t\t})\n\t\t\t.attr('fill', 'white')\n\t\t\t.attr('stroke-width', '.07')\n\t\t\t.attr('stroke', 'black');\n\n\t\tnode\n\t\t\t.append('text')\n\t\t\t.attr('x', (d) => {\n\t\t\t\treturn -(this.boxWidth / 20);\n\t\t\t})\n\t\t\t.attr('y', (d) => {\n\t\t\t\treturn this.boxWidth / 60;\n\t\t\t})\n\t\t\t.style('text-anchor', 'middle')\n\t\t\t.text((d) => {\n\t\t\t\treturn d.product.name;\n\t\t\t});\n\n\t\tconst link = this.svg.selectAll('path.link').data(links, (d) => {\n\t\t\tthis.data = d;\n\t\t\treturn d.target.id;\n\t\t});\n\n\t\t// append link into svg\n\t\tlink\n\t\t\t.enter()\n\t\t\t.insert('path', 'g')\n\t\t\t.attr('class', 'link')\n\t\t\t.attr('stroke', '#000')\n\t\t\t.attr('shape-rendering', 'crispEdges')\n\t\t\t.attr('d', (d) => {\n\t\t\t\tconst sourceX = d.source.x,\n\t\t\t\t\tsourceY = d.source.y + this.boxWidth / 2,\n\t\t\t\t\ttargetX = d.target.x,\n\t\t\t\t\ttargetY = d.target.y - this.boxWidth / 2;\n\t\t\t\treturn (\n\t\t\t\t\t'M' +\n\t\t\t\t\tsourceY +\n\t\t\t\t\t',' +\n\t\t\t\t\tsourceX +\n\t\t\t\t\t'H' +\n\t\t\t\t\t(sourceY + (targetY - sourceY) / 2) +\n\t\t\t\t\t'V' +\n\t\t\t\t\ttargetX +\n\t\t\t\t\t'H' +\n\t\t\t\t\ttargetY\n\t\t\t\t);\n\t\t\t});\n\t}\n}\n","import { NgModule } from '@angular/core';\nimport { SukuTreeComponent } from './suku-tree/suku-tree.component';\n@NgModule({\n  declarations: [SukuTreeComponent],\n  imports: [],\n  exports: [SukuTreeComponent]\n})\n\nexport class SukuWebcomponentsModule {\n\n }\n"],"names":["d3.layout","d3\r\n                    .select","Component","Input","NgModule"],"mappings":"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"}
